{% extends "people/base.html" %}

<!-- Home page -->
 
 {% block title %}Better Start{% endblock %}

 {% block content %}

<div class="container">

	{% include "people/person_header.html" %}

 	<div class="row">
 		<div class="col-md-12">
	 		<div class="panel panel-default">
	 			<div class="panel-heading">
	 				<h4 class="panel-title">FIND PERSON:</h4>
	 			</div>
		 		<div class="panel-body">
					<form action ="{% url 'add_relationship' person.pk %}" method="post">
						{% csrf_token %}
						<input type="hidden" name="action" value="search">
						<div class = "row form-group">
							{% for field in relationshipsearchform %}
								<div class = "col-md-4">{{ field.label_tag }} {{ field }}</div>
							{% endfor %}
							<div class = "col-md-4">{{ search_error }}</div>
						</div>
						<div class = "row">
	 						<div class = "col-xs-2">
	 							<input type="submit" value="Submit">
	 						</div>
	 					</div>
					</form>
				</div>
			</div>
		</div>
	</div>

	{% if search_results %}

		<div class="row">
			<div class="col-md-12">
		 		<div class="panel panel-default">
		 			<div class="panel-heading">
		 				<h4 class="panel-title">ADD A RELATIONSHIP TO AN EXISTING PERSON:</h4>
		 			</div>
		 			<div class="panel-body">
						<table class="table table-striped">
							<thead><tr>
								<th>NAME:</th>
								<th>DATE OF BIRTH:</th>
								<th>GENDER:</th>
							</tr></thead>
							<tbody>
						 		{% for result in search_results %}
						 				<tr>
						 					<td>
						 						<a href="{% url 'person' person.pk %}">
													{{ result.first_name }} {{ result.middle_names }} {{ result.last_name }}
												</a>
											</td>
											<td>
												{{ result.date_of_birth }}
											</td>
											<td>
												{{ result.gender }}
											</td>
										</tr>
									</div>
								{% endfor %}
							</tbody>
						</table>
					</div>
				</div>
			</div>
		</div>

	{% endif %}

	{% if addrelationshipform %}

		 <div class="row">
	 		<div class="col-md-12">
		 		<div class="panel panel-default">
		 			<div class="panel-heading">
		 				<h4 class="panel-title">ADD A RELATIONSHIP WITH A NEW PERSON:</h4>
		 			</div>
			 		<div class="panel-body">
						<form action ="{% url 'add_relationship' person.pk %}" method="post">
							{% csrf_token %}
							<input type="hidden" name="action" value="addrelationship">
							{% csrf_token %}
							{% for field in addrelationshipform %}
								{% if field.is_hidden %}
									{{ field }}
								{% else %}
									{% if field.name == 'relationship_type' %}
										<div class = "row form-group">
											<div class = "col-md-2"><b>Relationship:</b></div>
											<div class = "col-md-2">
												{{ person.first_name }} {{ person.last_name }} is the
											</div>
											<div class = "col-md-2">
												{{ field }}</div>
											<div class = "col-md-3"> of this person.</div>
										</div>
									{% else %}
										<div class = "row form-group">
											<div class = "col-md-2">{{ field.label_tag }}</b></div>
											<div class = "col-md-7">{{ field }}</div>
											<div class = "col-md-3 text-danger">{{ field.errors }}</div>
										</div>
									{% endif %}
								{% endif %}
							{% endfor %}
							<div class = "row">
		 						<div class = "col-xs-2">
		 							<input type="submit" value="Submit">
		 						</div>
		 					</div>
						</form>
					</div>
				</div>
			</div>
		</div>

	{% endif %}

 	<div class="row">
 		<div class="col-md-12">
 			<div class="panel panel-default">
				<div class="panel-heading">
		 				<h4 class="panel-title">EXISTING RELATIONSHIPS:</h4>
	 			</div>
		 		<div class="panel-body">
			 		{% for relationship_to in relationships_to %}
		 				<div class="col-md-12">
							{{ person.first_name }} {{ person.last_name }} is the 
							{{ relationship_to.relationship_type }} of
							<a href="{% url 'person' relationship_to.pk %}"> 
								{{ relationship_to.first_name }} {{ relationship_to.last_name }}
							</a>
						</div>
					{% endfor %}
				</div>
			</div>
		</div>
	</div>

</div>


{% endblock %}

