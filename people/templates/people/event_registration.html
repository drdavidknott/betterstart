{% extends "people/base.html" %}

<!-- Home page -->
 
 {% block title %}Better Start{% endblock %}

 {% block content %}

<div class="container">

	{% include "people/event_header.html" %}
 	
 	<div class="row">
 		<div class="col-md-12">
	 		<div class="panel panel-default">
	 			<div class="panel-heading">
	 				<h4 class="panel-title">FIND PERSON:</h4>
	 			</div>
		 		<div class="panel-body">
					{% crispy personsearchform %}
				</div>
			</div>
		</div>
	</div>

	{% if search_results %}

		<div class="row">
			<div class="col-md-12">
		 		<div class="panel panel-default">
		 			<div class="panel-heading">
		 				<h4 class="panel-title">ADD A REGISTRATION:</h4>
		 			</div>
		 			<div class="panel-body">
		 				<form action ="{% url 'event_registration' event.pk %}" method="post">
							{% csrf_token %}
							<input type="hidden" name="action" value="addregistration">
							<input type="hidden" name="search_keys" value="{{ search_keys }}">
							<table class="table table-striped">
								<thead>
									<tr>
										<th>NAME:</th>
										<th>REGISTERED:</th>
										<th>APOLOGIES:</th>
										<th>PARTICIPATED:</th>
										<th>ROLE:</th>
									</tr>
								</thead>
								<tbody>
							 		{% for result in search_results %}
						 				<tr>
						 					<td>
						 						<a href="{% url 'person' result.pk %}">
													{{ result }}
												</a>
											</td>
											<td>
												{% for field in addregistrationform %}
													{% if field.name == result.registered_field_name %}
														{{ field }}
													{% endif %}
												{% endfor %}
											</td>
											<td>
												{% for field in addregistrationform %}
													{% if field.name == result.apologies_field_name %}
														{{ field }}
													{% endif %}
												{% endfor %}
											</td>
											<td>
												{% for field in addregistrationform %}
													{% if field.name == result.participated_field_name %}
														{{ field }}
													{% endif %}
												{% endfor %}
											</td>
											<td>
												{% for field in addregistrationform %}
													{% if field.name == result.role_type_field_name %}
														{{ field }}
													{% endif %}
												{% endfor %}
											</td>
										</tr>
									{% endfor %}
								</tbody>
							</table>
		 					<input type="submit" value="Submit">
	 					</form>
					</div>
				</div>
			</div>
		</div>

	{% endif %}

	{% if editregistrationform %}

		<div class="row">
			<div class="col-md-12">
		 		<div class="panel panel-default">
		 			<div class="panel-heading">
		 				<h4 class="panel-title">EDIT EXISTING REGISTRATIONS:</h4>
		 			</div>
		 			<div class="panel-body">
		 				<form action ="{% url 'event_registration' event.pk %}" method="post">
							{% csrf_token %}
							<input type="hidden" name="action" value="editregistration">
							<input type="hidden" name="registration_keys" value="{{ registration_keys }}">
							<table class="table table-striped">
								<thead>
									<tr>
										<th>NAME:</th>
										<th>REGISTERED:</th>
										<th>APOLOGIES:</th>
										<th>PARTICIPATED:</th>
										<th>ROLE:</th>
									</tr>
								</thead>
								<tbody>
							 		{% for registration in registrations %}
						 				<tr>
						 					<td>
						 						<a href="{% url 'person' registration.person.pk %}">
													{{ registration.person }}
												</a>
											</td>
											<td>
												{% for field in editregistrationform %}
													{% if field.name == registration.registered_field_name %}
														{{ field }}
													{% endif %}
												{% endfor %}
											</td>
											<td>
												{% for field in editregistrationform %}
													{% if field.name == registration.apologies_field_name %}
														{{ field }}
													{% endif %}
												{% endfor %}
											</td>
											<td>
												{% for field in editregistrationform %}
													{% if field.name == registration.participated_field_name %}
														{{ field }}
													{% endif %}
												{% endfor %}
											</td>
											<td>
												{% for field in editregistrationform %}
													{% if field.name == registration.role_type_field_name %}
														{{ field }}
													{% endif %}
												{% endfor %}
											</td>
										</tr>
									{% endfor %}
								</tbody>
							</table>
							<div class = "row">
		 						<div class = "col-xs-2">
		 							<input type="submit" value="Submit">
		 						</div>
		 					</div>
	 					</form>
					</div>
				</div>
			</div>
		</div>

	{% endif %}

</div>


{% endblock %}

