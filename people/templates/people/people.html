{% extends "people/base.html" %}

{% load crispy_forms_tags %}

<!-- Home page -->
 
{% block title %}Better Start{% endblock %}

{% block content %}

<script type="text/javascript">
	$(document).ready(function() {
		{% if people %}
			$(".search-box").hide();
		{% endif %}
		$(".search-trigger").click(function() {
			$(".search-box").toggle()
		});
	});
</script>

<div class="container">

	<div class="row">
 		<div class="col-md-12">
	 		<div class="search-trigger">
	 			<h3>
		 			<span class="glyphicon glyphicon-user"></span><span class="glyphicon glyphicon-search"></span>
		 			Search for People:{% if number_of_people %} ({{ number_of_people }} found){% endif %}
	 			<h3>
	 		</div>
		</div>
	</div>

	<div class="row">
		<div class="col-xs-12">
 			<hr>
	 	</div>
	</div>

	<div class="row">
 		<div class="col-md-12">
		 	<div>{% crispy personsearchform %}</div>
		</div>
	</div>

	<div class="row">
			<div class="col-xs-12">
	 			<hr>
		 	</div>
	</div>

	{% if people %}

		<div class="row">
			<div class="col-md-12">
				<table class="table table-striped" id="people">
					<!--
					<thead><tr>
						<th>Name:</th>
						<th>Role:</th>
						<th>Relationships:</th>
					</tr></thead>
					-->
					<tbody>
				 		{% for person in people %}
			 				<tr>
			 					<td>
			 						<a href="{% url 'person' person.pk %}">
										{{ person }}
									</a>
								</td>
								<td>
									{{ person.default_role.role_type_name }}
								</td>
								<td>
									{% for rel_from in person.rel_from.all %}
										<div>
											{{ rel_from.relationship_type|capfirst }} of
												<a href="{% url 'person' rel_from.relationship_to.pk %}"> 
													{{ rel_from.relationship_to }}
												</a>
										</div>
									{% endfor %}
								</td>
							</tr>
						{% endfor %}
					</tbody>
				</table>
			</div>
		</div>

	{% endif %}

</div>

{% if page_list %}
	<div class="container">
		<div class="row">
			<div class="col-md-12">
				<form action ="{% url 'listpeople' %}" method="post">
					{% csrf_token %}
					<input type="hidden" name="action" value="search">
					<input type="hidden" name="names" value="{{ names }}">
					<input type="hidden" name="role_type" value="{{ role_type }}">
					<input type="hidden" name="ABSS_type" value="{{ ABSS_type }}">
					<input type="hidden" name="age_status" value="{{ age_status }}">
					<input type="hidden" name="trained_role" value="{{ trained_role }}">
					<input type="hidden" name="ward" value="{{ ward }}">
					<input type="hidden" name="include_people" value="{{ include_people }}">
					{% for target_page in page_list %}
						<input type="submit" name="page" value="{{ target_page }}">
					{% endfor %}
				</form>
			</div>
		</div>
	</div>
{% endif %}


{% endblock %}

